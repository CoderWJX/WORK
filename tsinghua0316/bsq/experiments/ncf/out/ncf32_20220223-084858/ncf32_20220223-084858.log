2022-02-23 08:48:58,656 - INFO  - Log file for this run: /home/duanhuiliu/tsinghua1215/experiments/ncf/out/ncf32_20220223-084858/ncf32_20220223-084858.log
2022-02-23 08:49:15,319 - INFO  - Dataset `ml-1m` size:
          Training Set = 4970845 (19418)
              Test Set = 604000 (6040)
2022-02-23 08:49:15,363 - INFO  - Created `ncf32` model for `ml-1m` dataset
          Use pre-trained model = /home/duanhuiliu/tsinghua1215/experiments/ncf/out/ncf32merge-baseline_20211216-063417/ncf32merge-baseline.pth
2022-02-23 08:49:15,398 - INFO  - Inserted qat quantizers into the original model
2022-02-23 08:49:24,861 - INFO  - initialized activation quantization parameters
2022-02-23 08:49:24,861 - INFO  - NeuMF(
  (embed_user_GMF): QuanEmbedding(
    6040, 32
    (quan_w_fn): LsqQuan()
    (quan_a_fn): Identity()
  )
  (embed_item_GMF): QuanEmbedding(
    3706, 32
    (quan_w_fn): LsqQuan()
    (quan_a_fn): Identity()
  )
  (embed_user_MLP): QuanEmbedding(
    6040, 128
    (quan_w_fn): IdentityQuan()
    (quan_a_fn): Identity()
  )
  (embed_item_MLP): QuanEmbedding(
    3706, 128
    (quan_w_fn): IdentityQuan()
    (quan_a_fn): Identity()
  )
  (MLP_layers): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): QuanLinear(
      in_features=256, out_features=128, bias=True
      (quan_w_fn): LsqQuan()
      (quan_a_fn): LsqQuan()
    )
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): QuanLinear(
      in_features=128, out_features=64, bias=True
      (quan_w_fn): LsqQuan()
      (quan_a_fn): LsqQuan()
    )
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): QuanLinear(
      in_features=64, out_features=32, bias=True
      (quan_w_fn): LsqQuan()
      (quan_a_fn): LsqQuan()
    )
    (8): ReLU()
  )
  (predict_layer): QuanLinear(
    in_features=64, out_features=1, bias=True
    (quan_w_fn): IdentityQuan()
    (quan_a_fn): IdentityQuan()
  )
)

2022-02-23 08:49:24,870 - INFO  - Program completed successfully ... exiting ...
2022-02-23 08:49:24,872 - INFO  - Optimizer: SGD (
           Parameter Group 0
               dampening: 0
               initial_lr: 5e-05
               lr: 5e-05
               momentum: 0.9
               nesterov: False
               weight_decay: 0.0
           
           Parameter Group 1
               dampening: 0
               initial_lr: 5e-05
               lr: 5e-05
               momentum: 0.9
               nesterov: False
               weight_decay: 0.0
           )
2022-02-23 08:49:24,873 - INFO  - LR scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f34ec63bfd0>

2022-02-23 08:49:24,873 - INFO  - >>>>>>>> Epoch -1 (pre-trained model evaluation)
2022-02-23 08:49:47,759 - INFO  - Saving checkpoint to:
             Current: /home/duanhuiliu/tsinghua1215/experiments/ncf/out/ncf32_20220223-084858/ncf32_checkpoint.pth.tar
                Best: /home/duanhuiliu/tsinghua1215/experiments/ncf/out/ncf32_20220223-084858/ncf32_best.pth.tar

2022-02-23 08:49:47,760 - INFO  - Scoreboard best 1 ==> Epoch [-1][Top1: 70.447   Top5: 42.813]
2022-02-23 08:49:47,760 - INFO  - loss:-1.0000	HR: 70.4470	NDCG: 42.8127
2022-02-23 08:49:47,760 - INFO  - >>>>>>>> Epoch   0
2022-02-23 08:56:08,239 - INFO  - Scoreboard best 1 ==> Epoch [0][Top1: 71.010   Top5: 43.099]
2022-02-23 08:56:08,239 - INFO  - Scoreboard best 2 ==> Epoch [-1][Top1: 70.447   Top5: 42.813]
2022-02-23 08:56:08,312 - INFO  - Saving checkpoint to:
             Current: /home/duanhuiliu/tsinghua1215/experiments/ncf/out/ncf32_20220223-084858/ncf32_checkpoint.pth.tar
                Best: /home/duanhuiliu/tsinghua1215/experiments/ncf/out/ncf32_20220223-084858/ncf32_best.pth.tar

2022-02-23 08:56:08,312 - INFO  - The time elapse of epoch 000 is: 00: 06: 20
2022-02-23 08:56:08,312 - INFO  - loss:0.2096	test_loss:6.2523	HR: 71.0099	NDCG: 43.0986	weight_lr: 0.0000500	initial_lr:0.0000500
2022-02-23 08:56:08,312 - INFO  - >>>>>>>> Epoch   1
2022-02-23 09:02:29,433 - INFO  - Scoreboard best 1 ==> Epoch [1][Top1: 71.325   Top5: 43.240]
2022-02-23 09:02:29,434 - INFO  - Scoreboard best 2 ==> Epoch [0][Top1: 71.010   Top5: 43.099]
2022-02-23 09:02:29,434 - INFO  - Scoreboard best 3 ==> Epoch [-1][Top1: 70.447   Top5: 42.813]
2022-02-23 09:02:29,498 - INFO  - Saving checkpoint to:
             Current: /home/duanhuiliu/tsinghua1215/experiments/ncf/out/ncf32_20220223-084858/ncf32_checkpoint.pth.tar
                Best: /home/duanhuiliu/tsinghua1215/experiments/ncf/out/ncf32_20220223-084858/ncf32_best.pth.tar

2022-02-23 09:02:29,499 - INFO  - The time elapse of epoch 001 is: 00: 06: 21
2022-02-23 09:02:29,499 - INFO  - loss:0.2087	test_loss:6.3640	HR: 71.3245	NDCG: 43.2397	weight_lr: 0.0000500	initial_lr:0.0000500
2022-02-23 09:02:29,499 - INFO  - >>>>>>>> Epoch -1 (final model evaluation)
2022-02-23 09:02:52,358 - INFO  - loss:-1.0000	HR: 71.3245	NDCG: 43.2397
2022-02-23 09:02:52,358 - INFO  - Program completed successfully ... exiting ...
